var N=Object.defineProperty;var b=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var y=(e,n,o)=>n in e?N(e,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[n]=o,B=(e,n)=>{for(var o in n||(n={}))I.call(n,o)&&y(e,o,n[o]);if(b)for(var o of b(n))M.call(n,o)&&y(e,o,n[o]);return e};import{e as O,a as $,b as K}from"./role.6235f9ff.js";import{g as L}from"./menu.6cfe7cca.js";import{d as R,r as k,i as F,u as S,f as U,a$ as P,b0 as T,_ as j,o as V,c as A,q as t,a,z as E,A as q,B as G,C as z,eR as H,E as J,H as Q,N as W,G as X,a9 as Y,b1 as Z,b2 as x}from"./index.1257e8b0.js";const ee=R({name:"AddOrUpdateDrawer",emits:["refresh"],setup(e,{emit:n}){const o=k(!1),d=k(),r=k(!1),p={roleId:"",roleName:"",entIdListStr:""},s=F(B({},p)),f={roleName:[{required:!0,trigger:["blur","input"],message:"\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0"}]};let _=F([]);const m=F([]);function C(u){s.entIdListStr=JSON.stringify(u)}const c=k(!1);function h(){L("MGR").then(u=>{_.push(...u)})}function g(){m.length=0,K(Object.assign({roleId:s.roleId})).then(u=>{u.records.map(l=>{m.push(l.entId)})})}function v(u){var l;(l=d.value)==null||l.restoreValidation(),Object.assign(s,p),o.value=!0,u?(r.value=!0,Object.assign(s,u),g()):r.value=!1}const w=S();function D(){d.value.validate(u=>{if(u)w.error("\u8BF7\u6B63\u786E\u586B\u5199\u6570\u636E\uFF01");else{c.value=!0;try{let l;r.value?l=O(s):l=$(s),l.then(()=>{w.success(`${r.value?"\u4FEE\u6539":"\u65B0\u589E"}\u6210\u529F`),c.value=!1,i(),n("refresh")})}catch(l){throw c.value=!1,l}}})}function i(){d.value.restoreValidation(),Object.assign(s,p),o.value=!1}return U(()=>{h()}),{showModal:o,isEdit:r,formParams:s,formRef:d,rules:f,entData:_,defaultCheckedKeys:m,updateCheckedKeys:C,formBtnLoading:c,confirmForm:D,CloseCircleTwotone:P,CheckCircleTwotone:T,closeDrawer:i,init:v}}}),ne=E(" \u53D6\u6D88 "),oe=E(" \u4FDD\u5B58 ");function te(e,n,o,d,r,p){const s=q,f=G,_=z,m=H,C=J,c=Q,h=W,g=X,v=Y,w=Z,D=x;return V(),A(D,{show:e.showModal,"onUpdate:show":n[1]||(n[1]=i=>e.showModal=i),width:600},{default:t(()=>[a(w,{title:e.isEdit?"\u4FEE\u6539":"\u65B0\u589E"},{footer:t(()=>[a(v,{align:"center"},{default:t(()=>[a(g,{onClick:e.closeDrawer},{icon:t(()=>[a(h,{component:e.CloseCircleTwotone},null,8,["component"])]),default:t(()=>[ne]),_:1},8,["onClick"]),a(g,{type:"info",loading:e.formBtnLoading,onClick:e.confirmForm},{icon:t(()=>[a(h,{component:e.CheckCircleTwotone},null,8,["component"])]),default:t(()=>[oe]),_:1},8,["loading","onClick"])]),_:1})]),default:t(()=>[a(c,{model:e.formParams,rules:e.rules,ref:"formRef","label-width":80},{default:t(()=>[a(C,{gutter:"12"},{default:t(()=>[a(_,{span:24},{default:t(()=>[a(f,{label:"\u89D2\u8272\u540D\u79F0",path:"roleName"},{default:t(()=>[a(s,{placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0",value:e.formParams.roleName,"onUpdate:value":n[0]||(n[0]=i=>e.formParams.roleName=i)},null,8,["value"])]),_:1})]),_:1}),a(_,{span:24},{default:t(()=>[a(f,{label:"\u8BF7\u9009\u62E9\u6743\u9650",path:"entIdListStr"},{default:t(()=>[a(m,{"block-line":"",cascade:"",checkable:"",data:e.entData,"key-field":"entId","label-field":"entName","default-checked-keys":e.defaultCheckedKeys,"onUpdate:checkedKeys":e.updateCheckedKeys,style:{width:"100%"}},null,8,["data","default-checked-keys","onUpdate:checkedKeys"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}var re=j(ee,[["render",te]]);export{re as default};
