var nt=Object.defineProperty,ot=Object.defineProperties;var at=Object.getOwnPropertyDescriptors;var Te=Object.getOwnPropertySymbols;var st=Object.prototype.hasOwnProperty,it=Object.prototype.propertyIsEnumerable;var Pe=(e,t,n)=>t in e?nt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,w=(e,t)=>{for(var n in t||(t={}))st.call(t,n)&&Pe(e,n,t[n]);if(Te)for(var n of Te(t))it.call(t,n)&&Pe(e,n,t[n]);return e},U=(e,t)=>ot(e,at(t));var x=(e,t,n)=>new Promise((o,a)=>{var u=s=>{try{r(n.next(s))}catch(c){a(c)}},d=s=>{try{r(n.throw(s))}catch(c){a(c)}},r=s=>s.done?o(s.value):Promise.resolve(s.value).then(u,d);r((n=n.apply(e,t)).next())});import{an as Oe,ao as rt,ap as lt,aq as ut,ar as ct,as as dt,at as ft,au as mt,av as gt,aw as pt,ax as xe,ay as vt,az as ht,aA as Ct,aB as _t,aC as yt,aD as bt,aE as wt,aF as St,aG as kt,r as $,p as l,w as ke,e as k,A as Nt,aH as Dt,aI as Tt,aJ as Pt,F as Ot,aK as Ft,aL as Et,L as K,aM as $t,aN as Rt,d as Ne,aO as Me,aP as zt,aQ as It,aR as ce,aS as z,W as ye,U as ee,O as G,aT as be,aU as Fe,Q as oe,al as He,_ as De,I as te,aV as At,o as O,g as W,s as Ee,v as $e,m as q,z as ge,a4 as ne,c as Y,q as R,a as A,a5 as V,a3 as pe,N as ve,aW as Ce,aX as Ue,af as Ve,f as We,aY as Ke,Z as Bt,i as Lt,aZ as xt,ad as fe,ac as Mt,a2 as qe,M as Ye,a6 as we,a7 as Ze,X as Ht,G as Ut,a_ as Vt}from"./index.1257e8b0.js";import{p as Se,s as Wt}from"./propTypes.c047a88a.js";import{c as Kt}from"./componentSetting.9cb0737a.js";import{t as qt,a as Yt,u as Zt}from"./index.esm.2ecd0768.js";import{_ as Gt}from"./Popconfirm.2f3d4e90.js";var Re=Oe?Oe.isConcatSpreadable:void 0;function jt(e){return rt(e)||lt(e)||!!(Re&&e&&e[Re])}function Ge(e,t,n,o,a){var u=-1,d=e.length;for(n||(n=jt),a||(a=[]);++u<d;){var r=e[u];t>0&&n(r)?t>1?Ge(r,t-1,n,o,a):ut(a,r):o||(a[a.length]=r)}return a}function Qt(e){var t=e==null?0:e.length;return t?Ge(e,1):[]}function Xt(e){return ct(dt(e,void 0,Qt),e+"")}function Jt(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}function en(e,t){return t.length<2?e:ft(e,mt(t,0,-1))}function tn(e,t){return gt(e,t)}function nn(e,t){return t=xe(t,e),e=en(e,t),e==null||delete e[pt(Jt(t))]}function on(e){return vt(e)?void 0:e}var an=1,sn=2,rn=4,ln=Xt(function(e,t){var n={};if(e==null)return n;var o=!1;t=ht(t,function(u){return u=xe(u,e),o||(o=u.length>1),u}),Ct(e,_t(e),n),o&&(n=yt(n,an|sn|rn,on));for(var a=t.length;a--;)nn(n,t[a]);return n}),un=ln,je=6e4,Qe=36e5;function ze(e,t){bt(1,arguments);var n=t||{},o=n.additionalDigits==null?2:wt(n.additionalDigits);if(o!==2&&o!==1&&o!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(!(typeof e=="string"||Object.prototype.toString.call(e)==="[object String]"))return new Date(NaN);var a=mn(e),u;if(a.date){var d=gn(a.date,o);u=pn(d.restDateString,d.year)}if(!u||isNaN(u.getTime()))return new Date(NaN);var r=u.getTime(),s=0,c;if(a.time&&(s=vn(a.time),isNaN(s)))return new Date(NaN);if(a.timezone){if(c=hn(a.timezone),isNaN(c))return new Date(NaN)}else{var _=new Date(r+s),g=new Date(0);return g.setFullYear(_.getUTCFullYear(),_.getUTCMonth(),_.getUTCDate()),g.setHours(_.getUTCHours(),_.getUTCMinutes(),_.getUTCSeconds(),_.getUTCMilliseconds()),g}return new Date(r+s+c)}var de={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},cn=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,dn=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,fn=/^([+-])(\d{2})(?::?(\d{2}))?$/;function mn(e){var t={},n=e.split(de.dateTimeDelimiter),o;if(n.length>2)return t;if(/:/.test(n[0])?o=n[0]:(t.date=n[0],o=n[1],de.timeZoneDelimiter.test(t.date)&&(t.date=e.split(de.timeZoneDelimiter)[0],o=e.substr(t.date.length,e.length))),o){var a=de.timezone.exec(o);a?(t.time=o.replace(a[1],""),t.timezone=a[1]):t.time=o}return t}function gn(e,t){var n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),o=e.match(n);if(!o)return{year:NaN,restDateString:""};var a=o[1]?parseInt(o[1]):null,u=o[2]?parseInt(o[2]):null;return{year:u===null?a:u*100,restDateString:e.slice((o[1]||o[2]).length)}}function pn(e,t){if(t===null)return new Date(NaN);var n=e.match(cn);if(!n)return new Date(NaN);var o=!!n[4],a=se(n[1]),u=se(n[2])-1,d=se(n[3]),r=se(n[4]),s=se(n[5])-1;if(o)return wn(t,r,s)?Cn(t,r,s):new Date(NaN);var c=new Date(0);return!yn(t,u,d)||!bn(t,a)?new Date(NaN):(c.setUTCFullYear(t,u,Math.max(a,d)),c)}function se(e){return e?parseInt(e):1}function vn(e){var t=e.match(dn);if(!t)return NaN;var n=_e(t[1]),o=_e(t[2]),a=_e(t[3]);return Sn(n,o,a)?n*Qe+o*je+a*1e3:NaN}function _e(e){return e&&parseFloat(e.replace(",","."))||0}function hn(e){if(e==="Z")return 0;var t=e.match(fn);if(!t)return 0;var n=t[1]==="+"?-1:1,o=parseInt(t[2]),a=t[3]&&parseInt(t[3])||0;return kn(o,a)?n*(o*Qe+a*je):NaN}function Cn(e,t,n){var o=new Date(0);o.setUTCFullYear(e,0,4);var a=o.getUTCDay()||7,u=(t-1)*7+n+1-a;return o.setUTCDate(o.getUTCDate()+u),o}var _n=[31,null,31,30,31,30,31,31,30,31,30,31];function Xe(e){return e%400===0||e%4===0&&e%100!==0}function yn(e,t,n){return t>=0&&t<=11&&n>=1&&n<=(_n[t]||(Xe(e)?29:28))}function bn(e,t){return t>=1&&t<=(Xe(e)?366:365)}function wn(e,t,n){return t>=1&&t<=53&&n>=0&&n<=6}function Sn(e,t,n){return e===24?t===0&&n===0:n>=0&&n<60&&t>=0&&t<60&&e>=0&&e<25}function kn(e,t){return t>=0&&t<=59}const Je=Symbol("s-table");function Nn(e){kt(Je,e)}function Dn(){return St(Je)}function Tn(e){const t=$(l(e).loading);ke(()=>l(e).loading,a=>{t.value=a});const n=k(()=>l(t));function o(a){t.value=a}return{getLoading:n,setLoading:o}}var et=(e=>(e.NInput="on-input",e.NInputNumber="on-input",e.NSelect="on-update:value",e.NSwitch="on-update:value",e.NCheckbox="on-update:value",e.NDatePicker="on-update:value",e.NTimePicker="on-update:value",e))(et||{});const Z=new Map;Z.set("NInput",Nt);Z.set("NInputNumber",Dt);Z.set("NSelect",Tt);Z.set("NSwitch",Pt);Z.set("NCheckbox",Ot);Z.set("NDatePicker",Ft);Z.set("NTimePicker",Et);const Pn=({component:e="NInput",rule:t=!0,ruleMessage:n,popoverVisible:o},{attrs:a})=>{const u=Z.get(e),d=K(u,a);return t?K($t,{"display-directive":"show",show:!!o,manual:"manual"},{trigger:()=>d,default:()=>K("span",{style:{color:"red",width:"90px",display:"inline-block"}},{default:()=>n})}):d};function On(e){return!e||!e.getBoundingClientRect?0:e.getBoundingClientRect()}function Fn(e){const t=document.documentElement,n=t.scrollLeft,o=t.scrollTop,a=t.clientLeft,u=t.clientTop,d=window.pageXOffset,r=window.pageYOffset,s=On(e),{left:c,top:_,width:g,height:F}=s,f=(d||n)-(a||0),m=(r||o)-(u||0),h=c+d,y=_+r,N=h-f,D=y-m,M=window.document.documentElement.clientWidth,B=window.document.documentElement.clientHeight;return{left:N,top:D,right:M-g-N,bottom:B-F-D,rightIncludeBody:M-N,bottomIncludeBody:B-D}}function Ie(e,t,n){e&&t&&n&&e.addEventListener(t,n,!1)}const me=new Map;let Ae;Rt||(Ie(document,"mousedown",e=>Ae=e),Ie(document,"mouseup",e=>{for(const{documentHandler:t}of me.values())t(e,Ae)}));function Be(e,t){let n=[];return Array.isArray(t.arg)?n=t.arg:n.push(t.arg),function(o,a){const u=t.instance.popperRef,d=o.target,r=a.target,s=!t||!t.instance,c=!d||!r,_=e.contains(d)||e.contains(r),g=e===d,F=n.length&&n.some(m=>m==null?void 0:m.contains(d))||n.length&&n.includes(r),f=u&&(u.contains(d)||u.contains(r));s||c||_||g||F||f||t.value()}}const En={beforeMount(e,t){me.set(e,{documentHandler:Be(e,t),bindingFn:t.value})},updated(e,t){me.set(e,{documentHandler:Be(e,t),bindingFn:t.value})},unmounted(e){me.delete(e)}};function Le(e){return e==="NInput"?"\u8BF7\u8F93\u5165":["NPicker","NSelect","NCheckbox","NRadio","NSwitch","NDatePicker","NTimePicker"].includes(e)?"\u8BF7\u9009\u62E9":""}const $n=Ne({name:"EditableCell",components:{FormOutlined:Me,CloseOutlined:zt,CheckOutlined:It,CellComponent:Pn},directives:{clickOutside:En},props:{value:{type:[String,Number,Boolean,Object],default:""},record:{type:Object},column:{type:Object,default:()=>({})},index:Se.number},setup(e){const t=Dn(),n=$(!1),o=$(),a=$(!1),u=$(""),d=$([]),r=$(e.value),s=$(e.value),c=k(()=>{var i;return((i=e.column)==null?void 0:i.editComponent)||"NInput"}),_=k(()=>{var i;return(i=e.column)==null?void 0:i.editRule}),g=k(()=>l(u)&&l(a)),F=k(()=>{const i=l(c);return["NCheckbox","NRadio"].includes(i)}),f=k(()=>{var L,J,re,le;const i=(J=(L=e.column)==null?void 0:L.editComponentProps)!=null?J:{},p=(le=(re=e.column)==null?void 0:re.editComponent)!=null?le:null,C=l(c),b={},S=l(F);let T=S?"checked":"value";const E=l(r);let P=S?ce(E)&&z(E)?E:!!E:E;C==="NDatePicker"&&(ye(P)?i.valueFormat?T="formatted-value":P=ze(P).getTime():ee(P)&&(i.valueFormat?T="formatted-value":P=P.map(ae=>ze(ae).getTime())));const v=p?et[p]:void 0;return U(w(w({placeholder:Le(l(c))},b),un(i,"onChange")),{[v]:D,[T]:P})}),m=k(()=>{var E,P;const{editComponentProps:i,editValueMap:p}=e.column,C=l(r);if(p&&G(p))return p(C);if(!l(c).includes("NSelect"))return C;const T=((E=i==null?void 0:i.options)!=null?E:l(d)||[]).find(v=>`${v.value}`==`${C}`);return(P=T==null?void 0:T.label)!=null?P:C}),h=k(()=>{const{align:i="center"}=e.column;return`edit-cell-align-${i}`}),y=k(()=>{const{editable:i}=e.record||{};return!!i});be(()=>{s.value=e.value}),be(()=>{const{editable:i}=e.column;(z(i)||z(l(y)))&&(n.value=!!i||l(y))});function N(){var i;l(y)||l((i=e.column)==null?void 0:i.editRow)||(u.value="",n.value=!0,He(()=>{var C;const p=l(o);(C=p==null?void 0:p.focus)==null||C.call(p)}))}function D(p){return x(this,arguments,function*(i){var T,E,P,v,L;const C=l(c),b=(E=(T=e.column)==null?void 0:T.editComponentProps)!=null?E:{};i?(i==null?void 0:i.target)&&Reflect.has(i.target,"value")?r.value=i.target.value:C==="NCheckbox"?r.value=i.target.checked:(ye(i)||z(i)||ce(i))&&(r.value=i):r.value=i,C==="NDatePicker"&&(ce(r.value)?b.valueFormat&&(r.value=Fe(r.value,b.valueFormat)):ee(r.value)&&b.valueFormat&&(r.value=r.value.map(J=>{Fe(J,b.valueFormat)})));const S=(v=(P=e.column)==null?void 0:P.editComponentProps)==null?void 0:v.onChange;S&&G(S)&&S(...arguments),(L=t.emit)==null||L.call(t,"edit-change",{column:e.column,value:l(r),record:oe(e.record)}),yield M()})}function M(){return x(this,null,function*(){const{column:i,record:p}=e,{editRule:C}=i,b=l(r);if(C){if(z(C)&&!b&&!ce(b)){a.value=!0;const S=l(c);return u.value=Le(S),!1}if(G(C)){const S=yield C(b,p);return S?(u.value=S,a.value=!0,!1):(u.value="",!0)}}return u.value="",!0})}function B(i=!0,p=!0){return x(this,null,function*(){var v;if(p&&!(yield M()))return!1;const{column:C,index:b,record:S}=e;if(!S)return!1;const{key:T}=C,E=l(r);if(!T)return;Wt(S,T,E),i&&((v=t.emit)==null||v.call(t,"edit-end",{record:S,index:b,key:T,value:E})),n.value=!1})}function j(){return x(this,null,function*(){var i;(i=e.column)!=null&&i.editRow||(yield B())})}function I(){var S;n.value=!1,r.value=s.value;const{column:i,index:p,record:C}=e,{key:b}=i;a.value=!0,u.value="",(S=t.emit)==null||S.call(t,"edit-cancel",{record:C,index:p,key:b,value:l(r)})}function Q(){var p;if(((p=e.column)==null?void 0:p.editable)||l(y))return;l(c).includes("NInput")&&I()}function X(i){d.value=i}function H(i,p){var C;e.record&&(ee(e.record[i])?(C=e.record[i])==null||C.push(p):e.record[i]=[p])}return e.record&&(H("submitCbs",B),H("validCbs",M),H("cancelCbs",I),e.column.key&&(e.record.editValueRefs||(e.record.editValueRefs={}),e.record.editValueRefs[e.column.key]=r),e.record.onCancelEdit=()=>{var i,p;ee((i=e.record)==null?void 0:i.cancelCbs)&&((p=e.record)==null||p.cancelCbs.forEach(C=>C()))},e.record.onSubmitEdit=()=>x(this,null,function*(){var i,p,C,b;if(ee((i=e.record)==null?void 0:i.submitCbs)){const S=(((p=e.record)==null?void 0:p.validCbs)||[]).map(v=>v());return(yield Promise.all(S)).every(v=>!!v)?((((C=e.record)==null?void 0:C.submitCbs)||[]).forEach(v=>v(!1,!1)),(b=t.emit)==null||b.call(t,"edit-row-end"),!0):void 0}})),{isEdit:n,handleEdit:N,currentValueRef:r,handleSubmit:B,handleChange:D,handleCancel:I,elRef:o,getComponent:c,getRule:_,onClickOutside:Q,ruleMessage:u,getRuleVisible:g,getComponentProps:f,handleOptionsChange:X,getWrapperClass:h,getRowEditable:y,getValues:m,handleEnter:j}}}),Rn={class:"editable-cell"},zn={class:"flex editable-cell-content"},In={class:"editable-cell-content-comp"},An={key:0,class:"editable-cell-action"};function Bn(e,t,n,o,a,u){const d=te("FormOutlined"),r=ve,s=te("CellComponent"),c=te("CheckOutlined"),_=te("CloseOutlined"),g=At("click-outside");return O(),W("div",Rn,[Ee(q("div",{class:"editable-cell-content",onClick:t[0]||(t[0]=(...F)=>e.handleEdit&&e.handleEdit(...F))},[ge(ne(e.getValues)+" ",1),e.column.editRow?V("",!0):(O(),Y(r,{key:0,class:"edit-icon"},{default:R(()=>[A(d)]),_:1}))],512),[[$e,!e.isEdit]]),Ee((O(),W("div",zn,[q("div",In,[A(s,pe(e.getComponentProps,{component:e.getComponent,popoverVisible:e.getRuleVisible,ruleMessage:e.ruleMessage,rule:e.getRule,class:e.getWrapperClass,ref:"elRef",onOptionsChange:e.handleOptionsChange,onPressEnter:e.handleEnter}),null,16,["component","popoverVisible","ruleMessage","rule","class","onOptionsChange","onPressEnter"])]),e.getRowEditable?V("",!0):(O(),W("div",An,[A(r,{class:"mx-2 cursor-pointer"},{default:R(()=>[A(c,{onClick:e.handleSubmit},null,8,["onClick"])]),_:1}),A(r,{class:"mx-2 cursor-pointer"},{default:R(()=>[A(_,{onClick:e.handleCancel},null,8,["onClick"])]),_:1})]))])),[[$e,e.isEdit],[g,e.onClickOutside]])])}var Ln=De($n,[["render",Bn]]);function xn(e){return(t,n)=>{const o=e.key,a=t[o];return t.onEdit=(u,d=!1)=>x(this,null,function*(){var r,s;return d||(t.editable=u),!u&&d?(yield(r=t.onSubmitEdit)==null?void 0:r.call(t))?(t.editable=!1,!0):!1:(!u&&!d&&((s=t.onCancelEdit)==null||s.call(t)),!0)}),K(Ln,{value:a,record:t,column:e,index:n})}}function Mn(e){const t=$(l(e).columns);let n=l(e).columns;const o=k(()=>{const f=Ce(l(t));return s(e,f),f||[]}),{hasPermission:a}=Ue();function u(f){const m=f.ifShow;let h=!0;return z(m)&&(h=m),G(m)&&(h=m(f)),h}const d=(f,m)=>K(Ve,null,{trigger:()=>f,default:()=>m}),r=k(()=>{const f=l(o);return Ce(f).filter(h=>a(h.auth)&&u(h)).map(h=>{h.ellipsis=typeof h.ellipsis=="undefined"?{tooltip:!0}:!1;const{edit:y}=h;if(y&&(h.render=xn(h),y)){const N=h.title;h.title=()=>d(K("span",{},[K("span",{style:{"margin-right":"5px"}},N),K(ve,{size:14},{default:()=>K(Me)})]),"\u8BE5\u5217\u53EF\u7F16\u8F91")}return h})});ke(()=>l(e).columns,f=>{t.value=f,n=f});function s(f,m){const{actionColumn:h}=l(f);!h||!m.find(y=>y.key==="action")&&m.push(w({},h))}function c(f){const m=Ce(f);if(!ee(m))return;if(!m.length){t.value=[];return}const h=n.map(y=>y.key);if(!ye(m[0]))t.value=m;else{const y=[];n.forEach(N=>{f.includes(N.key)&&y.push(w({},N))}),tn(h,m)||y.sort((N,D)=>h.indexOf(N.key)-h.indexOf(D.key)),t.value=y}}function _(){return oe(l(o)).map(m=>U(w({},m),{title:m.title,key:m.key,fixed:m.fixed||void 0}))}function g(f){return f?n.map(m=>m.key):n}function F(f,m){!f||!m||n.forEach(h=>{if(h.key===f){Object.assign(h,m);return}})}return{getColumnsRef:o,getCacheColumns:g,setCacheColumnsField:F,setColumns:c,getColumns:_,getPageColumns:r}}const{table:Hn}=Kt,{apiSetting:Un,defaultPageSize:Vn,pageSizes:Wn}=Hn,Kn=Vn,ie=Un,qn=Wn;function Yn(e,{getPaginationInfo:t,setPagination:n,setLoading:o,tableData:a},u){const d=$([]);be(()=>{a.value=l(d)}),ke(()=>l(e).dataSource,()=>{const{dataSource:f}=l(e);f&&(d.value=f)},{immediate:!0});const r=k(()=>{const{rowKey:f}=l(e);return f||(()=>"key")}),s=k(()=>{const f=l(d);return!f||f.length===0?l(d):l(d)});function c(f){return x(this,null,function*(){try{o(!0);const{request:m,pagination:h,paramsTransfer:y,listDataTransfer:N}=l(e);if(!m)return;const D=ie.pageField,M=ie.sizeField,B=ie.totalField,j=ie.listField;let I={};const{page:Q=1,pageSize:X=10}=l(t);z(h)&&!h||z(t)?I={}:(I[D]=f&&f[D]||Q,I[M]=X);let H=w({},I);y&&G(y)&&(H=(yield y(H))||H);const i=yield m(H),p=Math.ceil((i[B]||0)/X),C=i[D];p&&Q>p&&(n({[D]:p}),c(f));let b=i[j]?i[j]:i||[];N&&G(N)&&(b=(yield N(b))||b),d.value=b,n({[D]:C,[B]:p}),f&&f[D]&&n({[D]:f[D]||1}),u("fetch-success",{items:l(b),resultTotal:p})}catch(m){console.error(m),u("fetch-error",m),d.value=[]}finally{o(!1)}})}We(()=>{setTimeout(()=>{c()},16)});function _(f){d.value=f}function g(){return s.value}function F(f){return x(this,null,function*(){yield c(f)})}return{fetch:c,getRowKey:r,getDataSourceRef:s,getDataSource:g,setTableData:_,reload:F}}function Zn(e){const t=$({}),n=$(!0),o=k(()=>{const{pagination:s}=l(e);if(!l(n)||z(s)&&!s)return!1;const{totalField:c}=ie;return U(w(w({pageSize:Kn,pageSizes:qn,showSizePicker:!0,showQuickJumper:!0},z(s)?{}:s),l(t)),{pageCount:l(t)[c]})});function a(s){const c=l(o);t.value=w(w({},z(c)?{}:c),s)}function u(){return l(o)}function d(){return l(n)}function r(s){return x(this,null,function*(){n.value=s})}return{getPagination:u,getPaginationInfo:o,setShowPagination:r,getShowPagination:d,setPagination:a}}const Gn=U(w({},Ke.props),{title:{type:String,default:null},titleTooltip:{type:String,default:null},size:{type:String,default:"medium"},dataSource:{type:[Object],default:()=>[]},columns:{type:[Array],default:()=>[],required:!0},request:{type:Function,default:null},rowKey:{type:[String,Function],default:void 0},pagination:{type:[Object,Boolean],default:()=>{}},showPagination:{type:[String,Boolean],default:"auto"},actionColumn:{type:Object,default:null},canResize:Se.bool.def(!0),resizeHeightOffset:Se.number.def(0)});function jn(e,t=150,n){let o=()=>{e()};o=Zt(o,t);const u=()=>{n&&n.immediate&&o(),window.addEventListener("resize",o)},d=()=>{window.removeEventListener("resize",o)};return qt(()=>{u()}),Yt(()=>{d()}),[u,d]}const Qn=[{type:"menu",label:"\u7D27\u51D1",key:"small"},{type:"menu",label:"\u9ED8\u8BA4",key:"medium"},{type:"menu",label:"\u5BBD\u677E",key:"large"}],Xn=Ne({components:{QuestionCircleOutlined:Bt},props:w({},Gn),emits:["fetch-success","fetch-error","update:checked-row-keys","edit-end","edit-cancel","edit-row-end","edit-change"],setup(e,{emit:t}){const n=$(150),o=$(null),a=$(null);let u;const d=$([]),r=$(),s=k(()=>w(w({},e),l(r))),{getLoading:c,setLoading:_}=Tn(s),{getPaginationInfo:g,setPagination:F}=Zn(s),{getDataSourceRef:f,getDataSource:m,getRowKey:h,reload:y}=Yn(s,{getPaginationInfo:g,setPagination:F,tableData:d,setLoading:_},t),{getPageColumns:N,setColumns:D,getColumns:M,getCacheColumns:B,setCacheColumnsField:j}=Mn(s),I=Lt({tableSize:l(s).size||"medium",isColumnSetting:!1});function Q(v){F({page:v}),y()}function X(v){F({page:1,pageSize:v}),y()}function H(v){I.tableSize=v}function i(v){t("update:checked-row-keys",v)}const p=k(()=>I.tableSize),C=k(()=>{const v=l(f),L=v.length?`${l(n)}px`:"auto";return U(w({},l(s)),{loading:l(c),columns:oe(l(N)),rowKey:l(h),data:v,size:l(p),remote:!0,"max-height":L})}),b=k(()=>oe(l(g)));function S(v){r.value=w(w({},l(r)),v)}const T={reload:y,setColumns:D,setLoading:_,setProps:S,getColumns:M,getPageColumns:N,getCacheColumns:B,setCacheColumnsField:j,emit:t},E=k(()=>{const{canResize:v}=l(s);return v});function P(){return x(this,null,function*(){const v=l(o);if(!v||!l(E))return;const L=v==null?void 0:v.$el,J=L.querySelector(".n-data-table-thead "),{bottomIncludeBody:re}=Fn(J),le=64;let ae=2,tt=24;z(b)||(u=L.querySelector(".n-data-table__pagination"),u?ae+=u.offsetHeight||0:ae+=28);let ue=re-(le+ae+tt+(e.resizeHeightOffset||0));const he=e.maxHeight;ue=he&&he<ue?he:ue,n.value=ue})}return jn(P,280),We(()=>{He(()=>{P()})}),Nn(U(w({},T),{wrapRef:a,getBindValues:C})),U(w({},xt(I)),{tableElRef:o,getBindValues:C,getDataSource:m,densityOptions:Qn,reload:y,densitySelect:H,updatePage:Q,updatePageSize:X,updateCheckedRowKeys:i,pagination:b,tableAction:T})}}),Jn={class:"table-toolbar"},eo={class:"flex items-center table-toolbar-left"},to={key:0,class:"table-toolbar-left-title"},no={class:"flex items-center table-toolbar-right"},oo={class:"s-table"};function ao(e,t,n,o,a,u){const d=te("QuestionCircleOutlined"),r=ve,s=Ve,c=Ke;return O(),W(Ye,null,[q("div",Jn,[q("div",eo,[e.title?(O(),W("div",to,[ge(ne(e.title)+" ",1),e.titleTooltip?(O(),Y(s,{key:0,trigger:"hover"},{trigger:R(()=>[A(r,{size:"18",class:"ml-1 text-gray-400 cursor-pointer"},{default:R(()=>[A(d)]),_:1})]),default:R(()=>[ge(" "+ne(e.titleTooltip),1)]),_:1})):V("",!0)])):V("",!0),fe(e.$slots,"tableTitle",{},void 0,!0)]),q("div",no,[fe(e.$slots,"toolbar",{},void 0,!0)])]),q("div",oo,[A(c,pe({ref:"tableElRef"},e.getBindValues,{pagination:e.pagination,"onUpdate:page":e.updatePage,"onUpdate:pageSize":e.updatePageSize}),Mt({_:2},[qe(Object.keys(e.$slots),_=>({name:_,fn:R(g=>[fe(e.$slots,_,we(Ze(g)),void 0,!0)])}))]),1040,["pagination","onUpdate:page","onUpdate:pageSize"])])],64)}var bo=De(Xn,[["render",ao],["__scopeId","data-v-dc4179d6"]]);const so=Ne({name:"TableAction",components:{DownOutlined:Ht},props:{actions:{type:Array,default:null,required:!0},dropDownActions:{type:Array,default:null},style:{type:String,default:"button"},select:{type:Function,default:()=>{}}},setup(e){const{hasPermission:t}=Ue(),n=e.style==="button"?"default":e.style==="text"?"primary":"default",o=e.style==="button"?void 0:e.style==="text"?!0:void 0,a=k(()=>({text:o,type:n,size:"small"})),u=k(()=>(oe(e.dropDownActions)||[]).filter(s=>t(s.auth||[])&&d(s)).map(s=>{const{popConfirm:c}=s;return U(w(w({size:"small",text:o,type:n},s),c),{onConfirm:c==null?void 0:c.confirm,onCancel:c==null?void 0:c.cancel})}));function d(s){const c=s.ifShow;let _=!0;return z(c)&&(_=c),G(c)&&(_=c(s)),_}return{getActions:k(()=>(oe(e.actions)||[]).filter(s=>t(s.auth||[])&&d(s)).map(s=>{const{popConfirm:c}=s;return U(w(w({size:"small",text:o,type:n},s),c||{}),{enable:!!c})})),getDropdownList:u,getMoreProps:a}}}),io={class:"tableAction"},ro={class:"flex items-center justify-center"},lo={key:0},uo={key:0},co={class:"flex items-center"},fo=q("span",null,"\u66F4\u591A",-1);function mo(e,t,n,o,a,u){const d=ve,r=Ut,s=Gt,c=te("DownOutlined"),_=Vt;return O(),W("div",io,[q("div",ro,[(O(!0),W(Ye,null,qe(e.getActions,(g,F)=>(O(),W("div",{key:`${F}-${g.label}`},[g.popConfirm?(O(),Y(s,{key:0,onPositiveClick:g.popConfirm.confirm,onNegativeClick:g.popConfirm.cancel,"negative-text":g.popConfirm.cancelText||"\u53D6\u6D88","positive-text":g.popConfirm.okText||"\u786E\u8BA4"},{trigger:R(()=>[A(r,we(Ze(g)),{icon:R(()=>[g.icon?(O(),Y(d,{key:0,component:g.icon},null,8,["component"])):V("",!0)]),default:R(()=>[g.label?(O(),W("span",lo,ne(g.label),1)):V("",!0)]),_:2},1040)]),default:R(()=>[ge(" "+ne(g.popConfirm.title),1)]),_:2},1032,["onPositiveClick","onNegativeClick","negative-text","positive-text"])):(O(),Y(r,we(pe({key:1},g)),{icon:R(()=>[g.icon?(O(),Y(d,{key:0,component:g.icon},null,8,["component"])):V("",!0)]),default:R(()=>[g.label?(O(),W("span",uo,ne(g.label),1)):V("",!0)]),_:2},1040))]))),128)),e.dropDownActions&&e.getDropdownList.length?(O(),Y(_,{key:0,trigger:"hover",options:e.getDropdownList,onSelect:e.select},{default:R(()=>[fe(e.$slots,"more"),e.$slots.more?V("",!0):(O(),Y(r,pe({key:0},e.getMoreProps,{class:"mx-2","icon-placement":"right"}),{default:R(()=>[q("div",co,[fo,A(d,{size:"14",class:"ml-1"},{default:R(()=>[A(c)]),_:1})])]),_:1},16))]),_:3},8,["options","onSelect"])):V("",!0)])])}var wo=De(so,[["render",mo]]);export{bo as B,wo as T};
