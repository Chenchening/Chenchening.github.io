var ne=Object.defineProperty;var x=Object.getOwnPropertySymbols;var le=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var M=(c,n,r)=>n in c?ne(c,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[n]=r,E=(c,n)=>{for(var r in n||(n={}))le.call(n,r)&&M(c,r,n[r]);if(x)for(var r of x(n))pe.call(n,r)&&M(c,r,n[r]);return c};var I=(c,n,r)=>new Promise((g,B)=>{var N=i=>{try{v(r.next(i))}catch(d){B(d)}},C=i=>{try{v(r.throw(i))}catch(d){B(d)}},v=i=>i.done?g(i.value):Promise.resolve(i.value).then(N,C);v((r=r.apply(c,n)).next())});import{T as re,B as se}from"./TableAction.3aeeaebf.js";import{u as ie,B as ce}from"./useForm.8533c118.js";import{g as de,d as _e,a as me,e as fe,b as ve}from"./apps.6db532e1.js";import{c as he}from"./SecondStep.474c56b8.js";import{d as Fe,r as f,l as ge,u as be,i as P,f as Be,aG as Ce,N as we,o as O,c as L,q as u,L as Ae,J as ye,a as e,p as l,K as Ee,a$ as Ne,b0 as ke,a5 as Se,bR as De,z as b,A as Ie,G as Pe,B as Te,C as Ue,ah as Re,a9 as qe,ai as xe,E as Me,H as Oe,b1 as Le,b2 as $e}from"./index.1257e8b0.js";import Ve from"./payConfig.caaa5e0a.js";import"./propTypes.c047a88a.js";import"./componentSetting.9cb0737a.js";import"./index.esm.2ecd0768.js";import"./Popconfirm.2f3d4e90.js";import"./NStatus.04fd1a46.js";import"./MchPayPassageAddOrEdit.a0f5f051.js";import"./FirstStep.8b4a9fd4.js";import"./PayConfigDrawer.ae2c7fa3.js";import"./BasicUpload.b3a5fcb0.js";import"./isv.f10155b8.js";import"./AlipayPayConfig.45764682.js";import"./WxpayPayConfig.441e6533.js";import"./AlipayAuth.21daaba0.js";const je=b(" \u65B0\u5EFA "),He=b(" \u542F\u7528 "),Ge=b(" \u7981\u7528 "),Ke=b(" \u968F\u673A\u751F\u6210\u79C1\u94A5 "),ze=b(" \u53D6\u6D88"),Je=b(" \u4FDD\u5B58"),fu=Fe({setup(c){const n=f(!1),r={mchNo:{required:!0,trigger:["blur","input"],message:"\u8BF7\u8F93\u5165\u5546\u6237\u53F7"},appName:{required:!0,trigger:["blur","input"],message:"\u8BF7\u8F93\u5165\u5E94\u7528\u540D\u79F0"},appSecret:{trigger:["blur","input"],validator(o,t){return!t&&!n.value?new Error("\u8BF7\u8F93\u5165\u79D8\u94A5"):!0}}},g=f(""),B=[{field:"mchNo",component:"LBTextUp",defaultValue:g,componentProps:{placeholder:"\u5546\u6237\u53F7",onInput:o=>{console.log(o)}},rules:[{required:!1,message:"\u8BF7\u8F93\u5165\u5546\u6237\u53F7",trigger:["blur"]}]},{field:"appId",component:"LBTextUp",componentProps:{placeholder:"APPID",showButton:!1,onInput:o=>{console.log(o)}}},{field:"appName",component:"LBTextUp",componentProps:{placeholder:"\u5E94\u7528\u540D\u79F0",showButton:!1}},{field:"state",component:"NSelect",componentProps:{placeholder:"\u72B6\u6001",options:[{label:"\u5168\u90E8",value:null},{label:"\u7981\u7528",value:0},{label:"\u542F\u7528",value:1}],onUpdateValue:o=>{console.log(o)}}}],N=ge(),C=f(null),v=be(),i=f(),d=f(!1),w=f(!1),k={appId:"",mchNo:"",appName:null,state:0,appSecret:void 0,remark:null,appSecret_ph:"",createdAt:void 0,updatedAt:void 0},a=P(E({},k));let A=P({mchNo:""});const $=P({width:240,title:"\u64CD\u4F5C",key:"action",fixed:"right",align:"center",render(o){return Ae(re,{style:"button",actions:[{label:"\u4FEE\u6539",type:"primary",quaternary:!0,onClick:J.bind(null,o),ifShow:()=>!0,auth:["ENT_MCH_APP_EDIT"]},{label:"\u652F\u4ED8\u914D\u7F6E",type:"primary",quaternary:!0,onClick:W.bind(null,o),ifShow:()=>!0,auth:["ENT_MCH_APP_CONFIG"]},{label:"\u5220\u9664",type:"error",quaternary:!0,popConfirm:{title:"\u786E\u5B9A\u5220\u9664\u5417\uFF1F",confirm:Q.bind(null,o),cancel:()=>{}},ifShow:()=>!0,auth:["ENT_MCH_APP_DEL"]}]})}}),S=f(!1),[V,{}]=ie({labelWidth:80,schemas:B});Be(()=>{g.value=N.query.mchNo,A.mchNo=g.value||""});function j(){Object.assign(a,k),delete a.createdAt,delete a.updatedAt,n.value=!1,d.value=!0}const H=o=>I(this,null,function*(){return yield me(E(E({},A),o))});function G(o){console.log(o)}function D(){i.value.pagination.page=1,i.value.reload()}function K(o){o.preventDefault(),w.value=!0,C.value.validate(t=>{if(t)v.error("\u8BF7\u586B\u5199\u5B8C\u6574\u4FE1\u606F");else{a.appSecret||delete a.appSecret;let s;n.value===!0?s=fe(a.appId,a):s=ve(a),s.then(()=>{v.success(n.value?"\u4FEE\u6539\u6210\u529F":"\u6DFB\u52A0\u6210\u529F"),d.value=!1,D(),w.value=!1})}w.value=!1})}function z(o,t,s){let h="",F=t;const _=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];o&&(F=Math.round(Math.random()*(s-t))+t);for(var m=0;m<F;m++){var y=Math.round(Math.random()*(_.length-1));h+=_[y]}a.appSecret=h}function J(o){return I(this,null,function*(){de(o.appId).then(t=>{Object.assign(a,k),Object.assign(a,t),a.appSecret_ph=t.appSecret,a.appSecret=void 0,d.value=!0,n.value=!0})})}const T=f("");Ce("appId",T);function W(o){S.value=!0,T.value=o.appId}function Q(o){_e(o.appId).then(()=>{v.success("\u5220\u9664\u6210\u529F"),D()})}function X(o){A=Object.assign(A,o),D()}function Y(){g.value=""}return(o,t)=>{const s=Ie,h=we,F=Pe,_=Te,m=Ue,y=Re,U=qe,Z=xe,R=Me,ee=Oe,ue=Le,te=$e,ae=ye;return O(),L(ae,{bordered:!1,class:"proCard"},{default:u(()=>[e(l(ce),{clearOnReset:!0,onRegister:l(V),onSubmit:X,onReset:Y},{statusSlot:u(({model:p,field:q})=>[e(s,{value:p[q],"onUpdate:value":oe=>p[q]=oe},null,8,["value","onUpdate:value"])]),_:1},8,["onRegister"]),e(l(se),{columns:l(he),request:H,"row-key":p=>p.id,ref_key:"tableRef",ref:i,actionColumn:l($),"onUpdate:checkedRowKeys":G,"scroll-x":1090},{tableTitle:u(()=>[e(F,{type:"primary",onClick:j},{icon:u(()=>[e(h,null,{default:u(()=>[e(l(Ee))]),_:1})]),default:u(()=>[je]),_:1})]),_:1},8,["columns","row-key","actionColumn"]),e(te,{show:d.value,"onUpdate:show":t[8]||(t[8]=p=>d.value=p),"show-icon":!1,preset:"dialog",title:n.value?"\u7F16\u8F91":"\u65B0\u5EFA",width:600},{default:u(()=>[e(ue,{title:n.value?"\u7F16\u8F91":"\u65B0\u5EFA"},{footer:u(()=>[e(U,null,{default:u(()=>[e(F,{onClick:t[7]||(t[7]=()=>d.value=!1)},{icon:u(()=>[e(h,{component:l(Ne)},null,8,["component"])]),default:u(()=>[ze]),_:1}),e(F,{type:"info",loading:w.value,onClick:K},{icon:u(()=>[e(h,{component:l(ke)},null,8,["component"])]),default:u(()=>[Je]),_:1},8,["loading"])]),_:1})]),default:u(()=>[e(ee,{model:l(a),rules:r,ref_key:"formRef",ref:C,"label-width":80},{default:u(()=>[e(R,{gutter:"12"},{default:u(()=>[n.value?(O(),L(m,{key:0,span:12},{default:u(()=>[e(_,{label:"\u5E94\u7528AppId",path:"appId"},{default:u(()=>[e(s,{placeholder:"\u8BF7\u8F93\u5165\u5546\u6237\u53F7",value:l(a).appId,"onUpdate:value":t[0]||(t[0]=p=>l(a).appId=p),disabled:""},null,8,["value"])]),_:1})]),_:1})):Se("",!0),e(m,{span:12},{default:u(()=>[e(_,{label:"\u5546\u6237\u53F7",path:"mchNo"},{default:u(()=>[e(s,{placeholder:"\u8BF7\u8F93\u5165\u5546\u6237\u53F7",value:l(a).mchNo,"onUpdate:value":t[1]||(t[1]=p=>l(a).mchNo=p),disabled:n.value},null,8,["value","disabled"])]),_:1})]),_:1}),e(m,{span:12},{default:u(()=>[e(_,{label:"\u5E94\u7528\u540D\u79F0",path:"appName"},{default:u(()=>[e(s,{placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0",value:l(a).appName,"onUpdate:value":t[2]||(t[2]=p=>l(a).appName=p)},null,8,["value"])]),_:1})]),_:1}),e(m,{span:12},{default:u(()=>[e(_,{label:"\u72B6\u6001",path:"state"},{default:u(()=>[e(Z,{value:l(a).state,"onUpdate:value":t[3]||(t[3]=p=>l(a).state=p),name:"mchType"},{default:u(()=>[e(U,null,{default:u(()=>[e(y,{value:1,name:"status"},{default:u(()=>[He]),_:1}),e(y,{value:0,name:"status"},{default:u(()=>[Ge]),_:1})]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),e(_,{label:"\u79C1\u94A5 AppSecret",path:"appSecret",required:!n.value},{default:u(()=>[e(R,null,{default:u(()=>[e(m,{span:24},{default:u(()=>[e(s,{type:"textarea",placeholder:l(a).appSecret_ph||"\u8BF7\u8F93\u5165secret",value:l(a).appSecret,"onUpdate:value":t[4]||(t[4]=p=>l(a).appSecret=p)},null,8,["placeholder","value"])]),_:1}),e(m,null,{default:u(()=>[e(F,{ghost:"",color:"#4098fc",onClick:t[5]||(t[5]=p=>z(!1,128,0))},{icon:u(()=>[e(h,{component:l(De)},null,8,["component"])]),default:u(()=>[Ke]),_:1})]),_:1})]),_:1})]),_:1},8,["required"]),e(_,{label:"\u5907\u6CE8",path:"remark"},{default:u(()=>[e(s,{type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8",value:l(a).remark,"onUpdate:value":t[6]||(t[6]=p=>l(a).remark=p)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show","title"]),e(Ve,{show:S.value,"onUpdate:show":t[9]||(t[9]=p=>S.value=p)},null,8,["show"])]),_:1})}}});export{fu as default};
